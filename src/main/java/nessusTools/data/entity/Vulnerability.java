package nessusTools.data.entity;

import com.fasterxml.jackson.annotation.*;
import nessusTools.data.entity.template.*;
import nessusTools.data.persistence.*;

import javax.persistence.*;


@Entity(name = "Vulnerability")
@Table(name = "vulnerability")
@JsonIgnoreProperties({"id"})
public class Vulnerability extends GeneratedIdPojo
        implements ObjectLookupPojo<Vulnerability> {

    public static final ObjectLookupDao<Vulnerability> dao
            = new ObjectLookupDao<Vulnerability>(Vulnerability.class);

    private Integer count;

    private String score;

    @Column(name = "vuln_index")
    @JsonProperty("vuln_index")
    private Integer vulnIndex;

    @ManyToOne(cascade = {CascadeType.PERSIST, CascadeType.MERGE, CascadeType.REFRESH, CascadeType.DETACH})
    @JoinColumn(name = "plugin_name_id")
    @JsonProperty("plugin_name")
    private PluginName pluginName;

    private Integer severity;

    @Column(name = "plugin_id")
    @JsonProperty("plugin_id")
    private Integer pluginId; // foreign key for plugin ???????

    @Column(name = "severity_index")
    @JsonProperty("severity_index")
    private Integer severityIndex;

    private String cpe;

    private Boolean offline;

    @ManyToOne(cascade = {CascadeType.PERSIST, CascadeType.MERGE, CascadeType.REFRESH, CascadeType.DETACH})
    @JoinColumn(name="plugin_family_id")
    @JsonProperty("plugin_family")
    private PluginFamily pluginFamily;

    private Integer snoozed;

    public Integer getCount() {
        return count;
    }

    public void setCount(Integer count) {
        this.count = count;
    }

    public String getCpe() {
        return cpe;
    }

    public void setCpe(String cpe) {
        this.cpe = cpe;
    }

    public Boolean getOffline() {
        return offline;
    }

    public void setOffline(Boolean offline) {
        this.offline = offline;
    }

    public PluginFamily getPluginFamily() {
        return pluginFamily;
    }

    public void setPluginFamily(PluginFamily pluginFamily) {
        this.pluginFamily = pluginFamily;
    }

    public Integer getPluginId() {
        return pluginId;
    }

    public void setPluginId(Integer pluginId) {
        this.pluginId = pluginId;
    }

    public PluginName getPluginName() {
        return pluginName;
    }

    public void setPluginName(PluginName pluginName) {
        this.pluginName = pluginName;
    }

    public String getScore() {
        return score;
    }

    public void setScore(String score) {
        this.score = score;
    }

    public Integer getSeverity() {
        return severity;
    }

    public void setSeverity(Integer severity) {
        this.severity = severity;
    }

    public Integer getSeverityIndex() {
        return severityIndex;
    }

    public void setSeverityIndex(Integer severityIndex) {
        this.severityIndex = severityIndex;
    }

    public Integer getSnoozed() {
        return snoozed;
    }

    public void setSnoozed(Integer snoozed) {
        this.snoozed = snoozed;
    }

    public Integer getVulnIndex() {
        return vulnIndex;
    }

    public void setVulnIndex(Integer vulnIndex) {
        this.vulnIndex = vulnIndex;
    }

    @Override
    public void _set(Vulnerability o) {
        this.setId(o.getId());
        this.count = o.count;
        this.score = o.score;
        this.vulnIndex = o.vulnIndex;
        this.pluginName = o.pluginName;
        this.severity = o.severity;
        this.pluginId = o.pluginId;
        this.severityIndex = o.severityIndex;
        this.cpe = o.cpe;
        this.offline = o.offline;
        this.pluginFamily = o.pluginFamily;
        this.snoozed = o.snoozed;
        this.setExtraJson(o.getExtraJson());
    }
}
